# üìö Recursos del D√≠a 12: Security y Authentication

## üéØ Objetivo de los Recursos

Esta secci√≥n contiene material complementario, referencias y herramientas para profundizar en los conceptos de seguridad y autenticaci√≥n vistos durante el d√≠a 12.

## ÔøΩ Documentaci√≥n de Referencia

### **JWT (JSON Web Tokens)**

- [JWT.io](https://jwt.io/) - Decodificador y documentaci√≥n oficial
- [RFC 7519](https://tools.ietf.org/html/rfc7519) - Especificaci√≥n JWT
- [JWT Security Best Practices](https://auth0.com/blog/a-look-at-the-latest-draft-for-jwt-bcp/)

### **Password Hashing**

- [bcrypt npm package](https://www.npmjs.com/package/bcrypt)
- [OWASP Password Storage Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html)
- [Salt and Hash Passwords](https://auth0.com/blog/hashing-passwords-one-way-road-to-security/)

### **API Security**

- [OWASP API Security Top 10](https://owasp.org/www-project-api-security/)
- [Express.js Security Best Practices](https://expressjs.com/en/advanced/best-practice-security.html)
- [Node.js Security Checklist](https://blog.risingstack.com/node-js-security-checklist/)

## üõ°Ô∏è Herramientas de Seguridad

### **NPM Packages Recomendados**

```bash
# Autenticaci√≥n y autorizaci√≥n
pnpm install jsonwebtoken bcryptjs

# Rate limiting y protecci√≥n
pnpm install express-rate-limit helmet cors

# Validaci√≥n y sanitizaci√≥n
pnpm install joi express-validator

# Monitoreo y logging
pnpm install winston morgan

# Testing de seguridad
pnpm install -D supertest jest
```

### **Configuraci√≥n de Variables de Entorno**

```env
# JWT Configuration
JWT_SECRET=your-super-secret-jwt-key-256-bits-minimum
JWT_REFRESH_SECRET=your-refresh-secret-key
JWT_EXPIRES_IN=15m
JWT_REFRESH_EXPIRES_IN=7d

# Rate Limiting
RATE_LIMIT_WINDOW=15 # minutos
RATE_LIMIT_MAX=100 # requests por ventana

# CORS Configuration
CORS_ORIGIN=http://localhost:3000
CORS_CREDENTIALS=true

# Security Headers
HELMET_CSP_ENABLED=true
HELMET_HSTS_ENABLED=true
```

## üß™ Comandos de Testing

### **Pruebas de Seguridad**

```bash
# Ejecutar tests de seguridad
pnpm test security

# An√°lisis de vulnerabilidades
pnpm audit
pnpm audit fix

# Linting de seguridad
pnpm run lint:security
```

### **Testeo Manual con cURL**

```bash
# Test de autenticaci√≥n
curl -X POST http://localhost:3001/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"test@test.com","password":"password123"}'

# Test de endpoint protegido
curl -X GET http://localhost:3001/api/protected \
  -H "Authorization: Bearer your-jwt-token"

# Test de rate limiting
for i in {1..110}; do curl http://localhost:3001/api/test; done
```

## üîç Checklist de Seguridad

### **Antes de Deployment**

- [ ] Todas las credenciales en variables de entorno
- [ ] JWT secrets seguros (m√≠nimo 256 bits)
- [ ] Rate limiting configurado
- [ ] CORS apropiadamente configurado
- [ ] Headers de seguridad implementados
- [ ] Validaci√≥n en todos los endpoints
- [ ] Error handling sin exposici√≥n de datos sensibles
- [ ] Logging de eventos de seguridad
- [ ] Testing de vulnerabilidades completado

### **Monitoring en Producci√≥n**

- [ ] Logs de intentos de login fallidos
- [ ] Monitoreo de rate limiting
- [ ] Alertas de JWT tokens inv√°lidos
- [ ] Tracking de endpoints m√°s atacados
- [ ] An√°lisis de patrones de tr√°fico sospechoso

## üéØ Retos Adicionales

### **Reto Intermedio: Token Blacklisting**

Implementar un sistema de blacklist para tokens JWT revocados.

### **Reto Avanzado: Multi-Factor Authentication**

Agregar autenticaci√≥n de dos factores con c√≥digos SMS o TOTP.

### **Reto Experto: OAuth2 Integration**

Integrar autenticaci√≥n con Google/GitHub OAuth2.

## üö® Vulnerabilidades Comunes

### **JWT Vulnerabilities**

- [ ] Algoritmo "none" attack
- [ ] Weak signing keys
- [ ] Token exposure en URLs
- [ ] Lack of token expiration
- [ ] JWT confusion attacks

### **Password Attacks**

- [ ] Brute force attacks
- [ ] Rainbow table attacks
- [ ] Timing attacks
- [ ] Weak password policies
- [ ] Password reuse

### **API Vulnerabilities**

- [ ] SQL injection
- [ ] Cross-site scripting (XSS)
- [ ] Cross-site request forgery (CSRF)
- [ ] Server-side request forgery (SSRF)
- [ ] Insecure direct object references

## üìñ Lecturas Complementarias

### **Art√≠culos T√©cnicos**

- [The Ultimate Guide to handling JWTs on frontend clients](https://hasura.io/blog/best-practices-of-using-jwt-with-graphql/)
- [Node.js Security Checklist](https://blog.sqreen.com/nodejs-security-checklist/)
- [Express.js Security Best Practices](https://expressjs.com/en/advanced/best-practice-security.html)

### **Libros Recomendados**

- "Web Application Security" by Andrew Hoffman
- "Node.js Secure Coding" by Deepal Jayasekara
- "OAuth 2 in Action" by Justin Richer

### **Cursos Online**

- [OWASP Web Security Testing Guide](https://owasp.org/www-project-web-security-testing-guide/)
- [Node.js Security Course](https://github.com/lirantal/nodejs-security-course)
- [JWT Security Best Practices](https://auth0.com/blog/a-look-at-the-latest-draft-for-jwt-bcp/)

## üé™ Ejercicios Pr√°cticos Adicionales

### **Ejercicio 1: Security Headers Analysis**

Analizar y mejorar los headers de seguridad de una aplicaci√≥n existente.

### **Ejercicio 2: Rate Limiting Strategies**

Implementar diferentes estrategias de rate limiting (IP, usuario, endpoint).

### **Ejercicio 3: JWT Attack Simulation**

Simular ataques comunes contra JWT y implementar contramedidas.

### **Ejercicio 4: SQL Injection Prevention**

Identificar y corregir vulnerabilidades de SQL injection en c√≥digo existente.

## üèÜ Criterios de Evaluaci√≥n WorldSkills

### **T√©cnico (60%)**

- Implementaci√≥n correcta de JWT
- Password hashing seguro
- Rate limiting funcional
- CORS configurado apropiadamente
- Validaci√≥n robusta
- SQL injection prevention
- Security headers implementados

### **Calidad del C√≥digo (25%)**

- Estructura y organizaci√≥n
- Manejo de errores
- Comentarios y documentaci√≥n
- Mejores pr√°cticas seguidas

### **Funcionalidad (15%)**

- Autenticaci√≥n funcional
- Autorizaci√≥n por roles
- API endpoints protegidos
- Testing implementado

---

## üéØ Tips para el √âxito

1. **Prioriza la seguridad desde el dise√±o** - No la agregues despu√©s
2. **Usa librer√≠as probadas** - No reinventes la rueda
3. **Testa constantemente** - Seguridad es un proceso continuo
4. **Documenta todo** - Otros desarrolladores necesitan entender
5. **Mantente actualizado** - Vulnerabilidades surgen constantemente

¬°Recuerda: La seguridad no es opcional, es fundamental! üõ°Ô∏è

#### ‚ö° **Rate Limiting**

- [OWASP Rate Limiting](https://owasp.org/www-community/controls/Blocking_Brute_Force_Attacks)
- [Express Rate Limit](https://express-rate-limit.mintlify.app/)
- [DDoS Protection Strategies](https://www.cloudflare.com/learning/ddos/ddos-mitigation/)

#### üåê **CORS Security**

- [MDN CORS Documentation](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS)
- [OWASP CORS Guide](https://cheatsheetseries.owasp.org/cheatsheets/Cross-Origin_Resource_Sharing_Cheat_Sheet.html)

#### ‚úÖ **Input Validation**

- [OWASP Input Validation](https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html)
- [Joi Documentation](https://joi.dev/api/)
- [Express Validator Guide](https://express-validator.github.io/docs/)

#### üõ°Ô∏è **SQL Injection Prevention**

- [OWASP SQL Injection Prevention](https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html)
- [SQLite Prepared Statements](https://www.sqlite.org/lang_expr.html)

#### üîí **Security Headers**

- [OWASP Secure Headers Project](https://owasp.org/www-project-secure-headers/)
- [Helmet.js Documentation](https://helmetjs.github.io/)
- [CSP Guide](https://content-security-policy.com/)

## üõ†Ô∏è Herramientas Recomendadas

### **Testing de Seguridad**

- [OWASP ZAP](https://owasp.org/www-project-zap/) - Proxy de seguridad
- [Postman](https://www.postman.com/) - Testing de APIs
- [Burp Suite](https://portswigger.net/burp) - Herramienta de pentesting web
- [SQLMap](https://sqlmap.org/) - Testing de SQL injection (solo para pruebas)

### **An√°lisis de C√≥digo**

- [ESLint Security](https://github.com/nodesecurity/eslint-plugin-security)
- [Snyk](https://snyk.io/) - An√°lisis de vulnerabilidades
- [SonarQube](https://www.sonarqube.org/) - Calidad y seguridad de c√≥digo

### **Monitoreo y Logging**

- [Winston](https://github.com/winstonjs/winston) - Logging para Node.js
- [Morgan](https://github.com/expressjs/morgan) - HTTP request logger
- [Elastic Stack](https://www.elastic.co/) - An√°lisis de logs

## üìö Librer√≠as y Frameworks

### **Autenticaci√≥n y Autorizaci√≥n**

```bash
# JWT
pnpm install jsonwebtoken
pnpm install @types/jsonwebtoken

# OAuth2
pnpm install passport passport-oauth2
pnpm install passport-google-oauth20

# Session Management
pnpm install express-session
pnpm install connect-redis
```

### **Password Security**

```bash
# Hashing
pnpm install bcryptjs
pnpm install argon2
pnpm install scrypt

# Password validation
pnpm install joi
pnpm install validator
```

### **Rate Limiting**

```bash
# Basic rate limiting
pnpm install express-rate-limit
pnpm install express-slow-down

# Advanced rate limiting
pnpm install rate-limiter-flexible
pnpm install redis
```

### **Input Validation**

```bash
# Validation libraries
pnpm install joi
pnpm install express-validator
pnpm install ajv

# Sanitization
pnpm install dompurify
pnpm install express-mongo-sanitize
pnpm install xss
```

### **Security Headers**

```bash
# Helmet and security
pnpm install helmet
pnpm install cors
pnpm install hpp

# CSP and reporting
pnpm install content-security-policy-builder
```

## üéì Recursos de Aprendizaje

### **Cursos Online**

- [OWASP WebGoat](https://owasp.org/www-project-webgoat/) - Aplicaci√≥n vulnerable para aprender
- [DVWA](https://dvwa.co.uk/) - Damn Vulnerable Web Application
- [PortSwigger Web Security Academy](https://portswigger.net/web-security)

### **Libros Recomendados**

- "Web Application Security" by Andrew Hoffman
- "The Web Application Hacker's Handbook" by Dafydd Stuttard
- "OWASP Top 10" - Lista de vulnerabilidades m√°s cr√≠ticas

### **Certificaciones**

- OWASP Foundation Courses
- Certified Ethical Hacker (CEH)
- CISSP - Certified Information Systems Security Professional

## üîß Configuraciones de Producci√≥n

### **Environment Variables**

```env
# Producci√≥n
NODE_ENV=production
JWT_SECRET=clave-de-256-bits-generada-aleatoriamente
BCRYPT_ROUNDS=12

# Base de datos
DB_HOST=tu-servidor-db
DB_USER=usuario-limitado
DB_PASS=password-fuerte

# Rate limiting
RATE_LIMIT_MAX=100
RATE_LIMIT_WINDOW=900000

# CORS
CORS_ORIGIN=https://tu-dominio.com
CORS_CREDENTIALS=false
```

### **Nginx Configuration**

```nginx
# Rate limiting
limit_req_zone $binary_remote_addr zone=api:10m rate=10r/s;

server {
    listen 443 ssl http2;
    server_name tu-api.com;

    # SSL configuration
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/private.key;

    # Security headers
    add_header X-Frame-Options DENY;
    add_header X-Content-Type-Options nosniff;
    add_header X-XSS-Protection "1; mode=block";

    # Rate limiting
    limit_req zone=api burst=20 nodelay;

    location / {
        proxy_pass http://localhost:3000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

### **Docker Security**

```dockerfile
# Dockerfile seguro
FROM node:18-alpine AS builder

# Crear usuario no-root
RUN addgroup -g 1001 -S nodejs
RUN adduser -S nodeuser -u 1001

# Copiar y instalar dependencias
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production && npm cache clean --force

# Copiar c√≥digo
COPY . .

# Cambiar a usuario no-root
USER nodeuser

EXPOSE 3000

CMD ["node", "server.js"]
```

## üö® Security Checklist

### **Pre-Deployment**

- [ ] Variables de entorno configuradas
- [ ] Secrets no est√°n en el c√≥digo
- [ ] Rate limiting implementado
- [ ] Input validation completa
- [ ] SQL injection protegido
- [ ] XSS prevention activo
- [ ] CORS configurado restrictivamente
- [ ] Headers de seguridad aplicados
- [ ] Logging de seguridad activo
- [ ] SSL/TLS configurado
- [ ] Tests de seguridad ejecutados

### **Post-Deployment**

- [ ] Monitoreo de logs activo
- [ ] Alertas de seguridad configuradas
- [ ] Backups automatizados
- [ ] Actualizaciones de seguridad programadas
- [ ] Penetration testing ejecutado
- [ ] Incident response plan documentado

## üé™ Ejercicios Adicionales

### **Ejercicio Avanzado 1: OAuth2 Implementation**

Implementar autenticaci√≥n con Google OAuth2:

```javascript
// passport-config.js
const GoogleStrategy = require('passport-google-oauth20').Strategy;

passport.use(
  new GoogleStrategy(
    {
      clientID: process.env.GOOGLE_CLIENT_ID,
      clientSecret: process.env.GOOGLE_CLIENT_SECRET,
      callbackURL: '/auth/google/callback',
    },
    async (accessToken, refreshToken, profile, done) => {
      // Implementar l√≥gica de usuario
    }
  )
);
```

### **Ejercicio Avanzado 2: Rate Limiting con Redis**

Implementar rate limiting distribuido:

```javascript
const RedisStore = require('rate-limit-redis');
const redis = require('redis');

const redisClient = redis.createClient();

const rateLimiter = rateLimit({
  store: new RedisStore({
    client: redisClient,
    prefix: 'rl:',
  }),
  windowMs: 15 * 60 * 1000,
  max: 100,
});
```

### **Ejercicio Avanzado 3: CSP Reporting**

Implementar reporte de violaciones CSP:

```javascript
app.post(
  '/csp-report',
  express.json({ type: 'application/csp-report' }),
  (req, res) => {
    console.log('CSP Violation:', req.body);
    // Enviar a sistema de monitoreo
    res.status(204).send();
  }
);
```

## üèÜ Retos WorldSkills

### **Reto 1: Security Audit**

- Realizar auditor√≠a completa de seguridad
- Identificar al menos 10 vulnerabilidades potenciales
- Proponer soluciones espec√≠ficas
- Documentar hallazgos

### **Reto 2: Penetration Testing**

- Usar OWASP ZAP para testing automatizado
- Ejecutar tests manuales de SQL injection
- Verificar protecciones XSS
- Generar reporte de vulnerabilidades

### **Reto 3: Security Monitoring**

- Implementar dashboard de seguridad
- Configurar alertas autom√°ticas
- Crear m√©tricas de seguridad
- Establecer SLAs de respuesta

## üìû Soporte y Comunidad

### **Comunidades**

- [OWASP Community](https://owasp.org/membership/)
- [Node.js Security Working Group](https://github.com/nodejs/security-wg)
- [Information Security Stack Exchange](https://security.stackexchange.com/)

### **Reportar Vulnerabilidades**

- [Node.js Security](https://nodejs.org/en/security/)
- [HackerOne](https://hackerone.com/)
- [CVE Database](https://cve.mitre.org/)

¬°Mantente siempre actualizado con las √∫ltimas pr√°cticas de seguridad! üõ°Ô∏è
